{"version":3,"file":"functions.js","mappings":"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","sources":["webpack://excel-custom-functions/webpack/bootstrap","webpack://excel-custom-functions/./src/functions/functions.ts","webpack://excel-custom-functions/webpack/runtime/define property getters","webpack://excel-custom-functions/webpack/runtime/hasOwnProperty shorthand"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","/* global CustomFunctions */\r\n\r\n// This helper function replaces Google's Utilities.base64Encode\r\nfunction base64Encode(input: string): string {\r\n  return btoa(input);\r\n}\r\n\r\n/**\r\n * =================================================================\r\n * CORE API FUNCTIONS\r\n * =================================================================\r\n */\r\n\r\n//const BASE_URL = 'https://gapi.zellwwf.com/rpc/';\r\n\r\nconst BASE_URL = 'https://webrpc.nera.systems/rpc/';\r\n\r\nasync function registerDomain(indicesArray: string[], sharesArray: string[], owner: string, functionId: string, domainKey: string): Promise<any> {\r\n  const fullUrl = BASE_URL + 'RegisterDomain';\r\n\r\n  const payloadObject = {\r\n    payload: {\r\n      analyzer_id: owner,\r\n      function_id: functionId,\r\n      domain: {\r\n        [domainKey]: {\r\n          items: [\r\n            {\r\n              user: owner,\r\n              shares: sharesArray,\r\n              indices: indicesArray\r\n            }\r\n          ]\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  const options = {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n    body: JSON.stringify(payloadObject)\r\n  };\r\n\r\n  console.log('RegisterDomain Payload:', JSON.stringify(payloadObject));\r\n  const response = await fetch(fullUrl, options);\r\n  const responseBody = await response.json();\r\n  if (!response.ok) {\r\n    throw new Error(`API Error in registerDomain (${response.status}): ${JSON.stringify(responseBody)}`);\r\n  }\r\n  return responseBody;\r\n}\r\n\r\nasync function compute_privately(user_name: string, function_name: string, data_collection_dict: any): Promise<any> {\r\n  const fullUrl = BASE_URL + 'ComputePrivately';\r\n\r\n  const payloadObject = {\r\n    payload: {\r\n      user: user_name,\r\n      function_id: function_name,\r\n      data_collection_map: data_collection_dict\r\n    }\r\n  };\r\n\r\n  const options = {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json'\r\n    },\r\n    body: JSON.stringify(payloadObject)\r\n  };\r\n\r\n  console.log('ComputePrivately Payload:', JSON.stringify(payloadObject));\r\n  const response = await fetch(fullUrl, options);\r\n  const responseBody = await response.json();\r\n\r\n  if (!response.ok) {\r\n    throw new Error(`API Error in compute_privately (${response.status}): ${JSON.stringify(responseBody)}`);\r\n  }\r\n\r\n  // --- START OF FIX ---\r\n  // Check if the expected 'clear_data' field exists and is an array with at least one element\r\n  if (responseBody.clear_data && Array.isArray(responseBody.clear_data) && responseBody.clear_data.length > 0) {\r\n    // The result is the first item in the array.\r\n    // We use parseFloat to convert it from a string (\"NaN\" or \"123.45\") to a number.\r\n    const result = parseFloat(responseBody.clear_data[0]);\r\n    return result;\r\n  } else {\r\n    // If the response format is not what we expect, throw an error.\r\n    throw new Error(\"Invalid response format from server. 'clear_data' is missing or empty.\");\r\n  }\r\n  // --- END OF FIX ---\r\n}\r\n\r\n\r\n\r\nasync function _performNeraComputation(functionId: 'sum' | 'avg', userNameCell: any, indicesRange: any[][], dataRanges: any[][]): Promise<string | number> {\r\n\r\n  if (!userNameCell) {\r\n    return \"#ERROR: Please provide a valid username cell.\";\r\n  }\r\n  const ownerUsername: string = userNameCell.toString();\r\n  if (!ownerUsername) {\r\n    return \"#ERROR: Owner name in cell is empty.\";\r\n  }\r\n\r\n  if (!indicesRange || indicesRange.length === 0 || !Array.isArray(indicesRange[0])) {\r\n    return \"#ERROR: Please provide a valid indices range.\";\r\n  }\r\n  if (!dataRanges || dataRanges.length === 0 || !Array.isArray(dataRanges[0])) {\r\n    return \"#ERROR: Please provide a valid data range.\";\r\n  }\r\n\r\n  // 2. NEW: Check for mismatched range lengths\r\n  if (indicesRange.length !== dataRanges.length) {\r\n    return \"#ERROR: Indices and data ranges must have the same number of rows.\";\r\n  }\r\n\r\n  // console.log(`Data Range Received: ${JSON.stringify(dataRanges)}`);\r\n  console.log(\"userNameCell:\", userNameCell);\r\n  console.log(\"indicesRange:\", indicesRange);\r\n  console.log(\"dataRanges:\", dataRanges);\r\n\r\n\r\n\r\n  try {\r\n\r\n    console.log(`Owner Username: ${ownerUsername}`);\r\n    let allIndices: string[] = [];\r\n    let allShares: string[][] = [];\r\n\r\n\r\n    for (let i = 0; i < indicesRange.length; i++) {\r\n      const indexRow = indicesRange[i];\r\n      const dataRow = dataRanges[i];\r\n\r\n      const index = indexRow[0];\r\n      const hexData = dataRow[0];\r\n\r\n      if (index && hexData) {\r\n        allIndices.push(base64Encode(index.toString()));\r\n        allShares.push(hexData.toString().split('|'));\r\n      }\r\n    }\r\n\r\n\r\n    console.log(\"All Indices (base64):\", allIndices);\r\n    console.log(\"All Shares:\", allShares);\r\n\r\n\r\n    // --- START OF DEBUGGING LOG ---\r\n    // This log will help diagnose the \"NaN\" issue.\r\n    console.log(`Found ${allIndices.length} valid rows of data to process in the selected range.`);\r\n    // --- END OF DEBUGGING LOG ---\r\n\r\n    if (allIndices.length === 0) {\r\n      return \"#ERROR: No valid data found in the provided range.\";\r\n    }\r\n\r\n    const flattenedShares = allShares.flat();\r\n    const domainKey = \"x\";\r\n\r\n    const registerResponse = await registerDomain(allIndices, flattenedShares, ownerUsername, functionId, domainKey);\r\n    console.log(\"Full API Response from registerDomain:\", JSON.stringify(registerResponse, null, 2));\r\n\r\n    const dataCollectionMap = registerResponse.data_collection_map;\r\n\r\n    if (!dataCollectionMap) {\r\n      throw new Error(\"Failed to get data_collection_map from registration step.\");\r\n    }\r\n\r\n    const finalResult = await compute_privately(ownerUsername, functionId, dataCollectionMap);\r\n    return finalResult;\r\n\r\n  } catch (e) {\r\n    console.error(e);\r\n    return `#ERROR: ${e.message}`;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * Performs a private summation on secretly shared data.\r\n * @customfunction SUM\r\n * @param {any} userNameCell The username of the data owner.\r\n * @param {any[][]} indicesRanges The range containing indices.\r\n * @param {any[][]} dataRanges A single range or multiple ranges to process. \r\n * @returns {Promise<string | number>} A promise that resolves with the sum or an error.\r\n */\r\nexport async function SUM(userNameCell: any, indicesRanges: any[][], dataRanges: any[][]): Promise<string | number> {\r\n  return _performNeraComputation(\"sum\", userNameCell, indicesRanges, dataRanges);\r\n}\r\n\r\n/**\r\n * @customfunction AVG\r\n * @param {any} userNameCell The username of the data owner.\r\n * @param {any[][]} indicesRanges The range containing indices.\r\n * @param {any[][]} dataRanges A single range or multiple ranges to process.\r\n * @returns {Promise<string | number>} A promise that resolves with the average or an error.\r\n */\r\nexport async function AVG(userNameCell: any, indicesRanges: any[][], dataRanges: any[][]): Promise<string | number> {\r\n  return _performNeraComputation(\"avg\", userNameCell, indicesRanges, dataRanges);\r\n}\r\n\r\n// Associate the function names in Excel with the JavaScript functions\r\nCustomFunctions.associate(\"NERA.SUM\", SUM);\r\nCustomFunctions.associate(\"NERA.AVG\", AVG);\nCustomFunctions.associate(\"SUM\", SUM);\nCustomFunctions.associate(\"AVG\", AVG);","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }"],"names":["__webpack_require__","e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","_defineProperty","_typeof","toPrimitive","String","_toPrimitive","_toPropertyKey","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","base64Encode","input","btoa","exports","definition","key","get","obj","prop","hasOwnProperty","BASE_URL","registerDomain","_x","_x2","_x3","_x4","_x5","_registerDomain","_callee","indicesArray","sharesArray","owner","functionId","domainKey","fullUrl","payloadObject","options","response","responseBody","_context","payload","analyzer_id","function_id","domain","items","user","shares","indices","method","headers","body","JSON","stringify","console","log","fetch","json","ok","Error","concat","status","compute_privately","_x6","_x7","_x8","_compute_privately","_callee2","user_name","function_name","data_collection_dict","result","_context2","data_collection_map","clear_data","Array","isArray","parseFloat","_performNeraComputation","_x9","_x0","_x1","_x10","_performNeraComputation2","_callee3","userNameCell","indicesRange","dataRanges","ownerUsername","allIndices","allShares","indexRow","dataRow","index","hexData","flattenedShares","registerResponse","dataCollectionMap","finalResult","_t","_context3","toString","push","split","flat","error","message","SUM","_x11","_x12","_x13","_SUM","_callee4","indicesRanges","_context4","AVG","_x14","_x15","_x16","_AVG","_callee5","_context5","CustomFunctions","associate"],"sourceRoot":""}